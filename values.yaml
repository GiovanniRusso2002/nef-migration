# =============================================================================
# SERVICE TOGGLES
# =============================================================================
services:
  asSessionWithQos: true
  trafficInfluence: true
  monitoringEvent: true
  ueIdentity: true
  ueId: true
  ueAddress: true
  ueProfile: true
  datasetExporter: true
  coreNetworkService: true
  coreSimulator: true
  capif: true
  redis: true
  redisInsight: true
  prometheus: true
  grafana: true

# =============================================================================
# GLOBAL DEFAULTS
# =============================================================================
global:
  imageTag: "develop"
  imageRegistry: "openexposure"

  # Default NBI (Northbound Interface) settings
  nbi:
    httpVersion: 1
    useTLS: false
    port: 8080

  # Default SBI (Southbound Interface) settings
  sbi:
    httpVersion: 2
    identitySvc: "http://nef-ue-identity:8080"
    nrfSvc: "http://nrf.net01.3gpp.eurecom.fr"
    useNrf: false
    pcfSvc: "http://core-simulator:8080"

  # Core Network HTTP version (used by ueProfile, coreNetworkService)
  cnHttpVersion: 1

  # Common service defaults
  https: false

  supportedFeatures: "3fff"

# =============================================================================
# IMAGES
# =============================================================================
images:
  asSessionWithQos: "openexposure/as-session-with-qos:develop"
  trafficInfluence: "openexposure/traffic-influence:develop"
  monitoringEvent: "openexposure/monitoring-event:develop"
  ueIdentity: "openexposure/ue-identity-service:develop"
  ueId: "openexposure/ue-id:develop"
  ueAddress: "openexposure/ue-address:develop"
  ueProfile: "openexposure/ue-profile-service:develop"
  datasetExporter: "openexposure/dataset-exporter:develop"
  coreNetworkService: "openexposure/core-network-service:develop"
  coreSimulator: "openexposure/core-simulator:develop"
  capif: "openexposure/capif-service:develop"
  redis: "redis/redis-stack-server:latest"
  redisInsight: "redis/redisinsight:latest"
  prometheus: "prom/prometheus:latest"
  grafana: "grafana/grafana:latest"

# =============================================================================
# REPLICAS
# =============================================================================
replicas:
  default: 1
  # Override specific services if needed:
  # coreSimulator: 2
  # prometheus: 1

  # =============================================================================
  # REDIS
  # =============================================================================
redis:
  address: "redis-stack:6379"
  uri: "redis://redis-stack:6379/"

# =============================================================================
# CORE SIMULATOR
# =============================================================================
coreSimulator:
  sbiPort: 8080
  oamPort: 8081
  initOnStartup: true
  httpVersion: 2
  fqdn: "core-simulator"
  simulationProfile:
    plmn:
      mcc: "001"
      mnc: "01"
    dnn: "internet"
    slice:
      sst: 1
      sd: "FFFFFF"
    numOfUe: 20
    numOfgNB: 10
    arrivalRate: 2

# =============================================================================
# MONITORING EVENT
# =============================================================================
monitoringEvent:
  config:
    enabled: true
    data:
      nbi:
        fqdn: "3gpp-monitoring-event.local"
        # httpVersion, useTLS, port: use global.nbi defaults
      sbi:
        # identitySvc: use global.sbi.identitySvc
        httpVersion: 2
      # supportedFeatures: uses global.supportedFeatures

      # =============================================================================
      # AS SESSION WITH QOS
      # =============================================================================
asSessionWithQos:
  nbi:
    fqdn: "3gpp-as-session-with-qos.local"
    # httpVersion, useTLS, port: use global.nbi defaults
  sbi: {}
    # nrfSvc, useNrf, pcfSvc: use global.sbi defaults
    # httpVersion: use global.sbi.httpVersion
    # supportedFeatures: uses global.supportedFeatures
  qosConfig:
    qos-e:
      marBwDl: 120000
      marBwUl: 120000
      mediaType: CONTROL
    qos2:
      marBwDl: 240000
      marBwUl: 240000
      mediaType: CONTROL
    qos3:
      marBwDl: 480000
      marBwUl: 480000
      mediaType: AUDIO
    qos4:
      marBwDl: 960000
      marBwUl: 960000
      mediaType: VIDEO

# =============================================================================
# TRAFFIC INFLUENCE
# =============================================================================
trafficInfluence:
  nbi:
    fqdn: "3gpp-traffic-influence.local"
    # httpVersion, useTLS, port: use global.nbi defaults
  sbi: {}
    # nrfSvc, useNrf, pcfSvc: use global.sbi defaults
    # httpVersion: use global.sbi.httpVersion

# =============================================================================
# UE IDENTITY
# =============================================================================
ueIdentity:
  config:
    enabled: true
    data: {}
      # httpPort, nbiPort: use global.nbi.port
      # https: use global.https
      # httpVer: use global.nbi.httpVersion
      # redisSvc: resolved from redis.address in template

# =============================================================================
# UE ID
# =============================================================================
ueId:
  config:
    enabled: true
    data:
      nbi:
        fqdn: "3gpp-ueid.local"
        # httpVersion, useTLS, port: use global.nbi defaults
      sbi:
        httpVersion: 1
        # identitySvc: use global.sbi.identitySvc
        # supportedFeatures: uses global.supportedFeatures
        # capifSvc: resolved from capif.address in template

        # =============================================================================
        # UE ADDRESS
        # =============================================================================
ueAddress:
  config:
    enabled: true
    data:
      nbi:
        fqdn: "3gpp-ue-address.local"
        # httpVersion, useTLS, port: use global.nbi defaults
      sbi:
        profileSvc: "http://nef-ue-profile:8080"
        httpVersion: 1
        # identitySvc: use global.sbi.identitySvc
        # supportedFeatures: uses global.supportedFeatures
        # capifSvc: resolved from capif.address in template

        # =============================================================================
        # UE PROFILE
        # =============================================================================
ueProfile:
  config:
    enabled: true
    data: {}
      # https: use global.https
      # cnHttpVersion: use global.cnHttpVersion
      # nbiPort: use global.nbi.port
      # redisSvc: resolved from redis.address in template

# =============================================================================
# CORE NETWORK
# =============================================================================
coreNetworkService:
  config:
    enabled: true
    data:
      # useNrf: use global.sbi.useNrf
      # cnHttpVersion: use global.cnHttpVersion
      # redisAddr, redisSvc: resolved from redis.address in template
      amf:
        ipAddr: "http://nef-core-simulator:8080"
        subscrRoute: "/namf-evts/v1"
        apiRoute: "/test/amf"
        notifyCorrelationId: "string"
        notificationId: "1"
        notificationForwardRoute: "/sbi/notification/amf"
      smf:
        ipAddr: "http://nef-core-simulator:8080"
        subscrRoute: "/nsmf_event-exposure/v1"
        apiRoute: "/test/smf"
        notifyCorrelationId: "string"
        notificationId: "2"
        notificationForwardRoute: "/sbi/notification/smf"
      eventNotifyUri: "http://nef-core-network:9090"
      serverAddr: "0.0.0.0:9090"

# =============================================================================
# CAPIF
# =============================================================================
capif:
  address: "nef-capif:8080"
  fqdn: "vm03.netsoft.cs.eurecom.fr"
  authPort: "8084"
  username: "nef-semproj"

# =============================================================================
# GRAFANA
# =============================================================================
grafana:
  # adminUser and adminPassword: set via secret nef-grafana-secret
  dashboards:
    prometheus:
      datasourceUrl: "http://nef-prometheus:9090"

# =============================================================================
# INGRESS
# =============================================================================
ingress:
  enabled: true
  className: "nginx"
  host: "nef.local"
  tlsSecretName: "nef-tls-cert"

  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    # SSL/TLS
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    nginx.ingress.kubernetes.io/ssl-protocols: "TLSv1.2 TLSv1.3"
    nginx.ingress.kubernetes.io/ssl-ciphers: "ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305"
    nginx.ingress.kubernetes.io/ssl-prefer-server-ciphers: "true"
    # Rate limiting
    nginx.ingress.kubernetes.io/limit-rps: "100"
    nginx.ingress.kubernetes.io/limit-connections: "50"
    # Security headers
    nginx.ingress.kubernetes.io/configuration-snippet: |
      more_set_headers "X-Frame-Options: DENY";
      more_set_headers "X-Content-Type-Options: nosniff";
      more_set_headers "X-XSS-Protection: 1; mode=block";
      more_set_headers "Referrer-Policy: strict-origin-when-cross-origin";
      more_set_headers "Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'";

  # Service paths (DRY: port 8080 is default for NEF services)
  paths:
  - path: /3gpp-as-session-with-qos
    service: nef-as-session-with-qos
  - path: /3gpp-traffic-influence
    service: nef-traffic-influence
  - path: /3gpp-monitoring-event
    service: nef-monitoring-event
  - path: /3gpp-ue-id
    service: nef-ue-id
  - path: /3gpp-ue-address
    service: nef-ue-address
  - path: /grafana
    service: nef-grafana
    port: 3000
  - path: /prometheus
    service: nef-prometheus
    port: 9090

# =============================================================================
# POLICIES
# =============================================================================
networkPolicy:
  enabled: true

podDisruptionBudget:
  enabled: true

# =============================================================================
# RESOURCE DEFAULTS
# =============================================================================
# Resources are defined in templates with sensible defaults.
# Override per-service if needed:
#
# resources:
#   default:
#     requests: { cpu: 100m, memory: 128Mi }
#     limits: { cpu: 500m, memory: 512Mi }
#   coreNetworkService:
#     requests: { cpu: 150m, memory: 256Mi }
#     limits: { cpu: 1000m, memory: 1Gi }
#   coreSimulator:
#     requests: { cpu: 200m, memory: 256Mi }
#     limits: { cpu: 1000m, memory: 1Gi }
#   prometheus:
#     requests: { cpu: 200m, memory: 512Mi }
#     limits: { cpu: 2000m, memory: 2Gi }
#   grafana:
#     requests: { cpu: 100m, memory: 256Mi }
#     limits: { cpu: 500m, memory: 1Gi }
#   redis:
#     requests: { cpu: 100m, memory: 256Mi }
#     limits: { cpu: 1000m, memory: 1Gi }

# =============================================================================
# SECURITY CONTEXT DEFAULTS
# =============================================================================
# Default security context (applied in templates):
#   runAsNonRoot: true
#   runAsUser: 10001
#   allowPrivilegeEscalation: false
#   readOnlyRootFilesystem: true
#   capabilities: { drop: [ALL] }
#
# Exceptions (defined in service templates):
#   prometheus: runAsUser: 65534 (nobody)
#   grafana: runAsUser: 472
#   redisInsight: runAsUser: 1000, readOnlyRootFilesystem: false
