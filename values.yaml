# =============================================================================
# NEF Helm Chart - Configuration Values
# =============================================================================

# =============================================================================
# SERVICE TOGGLES - Enable/disable services
# =============================================================================
services:
  asSessionWithQos: true
  trafficInfluence: true
  monitoringEvent: true
  ueIdentity: true
  ueId: true
  ueAddress: true
  ueProfile: true
  datasetExporter: true
  coreNetwork: true
  coreSimulator: true
  capif: true
  redis: true
  redisInsight: true
  prometheus: true
  grafana: true

# =============================================================================
# IMAGES
# =============================================================================
images:
  asSessionWithQos: "openexposure/as-session-with-qos:develop"
  trafficInfluence: "openexposure/traffic-influence:develop"
  monitoringEvent: "openexposure/monitoring-event:develop"
  ueIdentity: "openexposure/ue-identity-service:develop"
  ueId: "openexposure/ue-id:develop"
  ueAddress: "openexposure/ue-address:develop"
  ueProfile: "openexposure/ue-profile-service:develop"
  datasetExporter: "openexposure/dataset-exporter:develop"
  coreNetwork: "openexposure/core-network-service:develop"
  coreSimulator: "openexposure/core-simulator:develop"
  capif: "openexposure/capif-service:develop"
  redis: "redis/redis-stack-server:latest"
  redisInsight: "redis/redisinsight:latest"
  prometheus: "prom/prometheus:latest"
  grafana: "grafana/grafana:latest"

# =============================================================================
# REPLICAS
# =============================================================================
replicas:
  default: 1 # replicaCount
  # Override specific services here if you need different replica counts:
  # serviceName: value

  # =============================================================================
  # REDIS
  # =============================================================================
redis:
  address: "redis-stack:6379"
  uri: "redis://redis-stack:6379/"

# =============================================================================
# CORE SIMULATOR
# =============================================================================
coreSimulator:
  simulationProfile:
    plmn: { mcc: "001", mnc: "01" }
    dnn: "internet"
    slice: { sst: 1, sd: "FFFFFF" }
    numOfUe: 20
    numOfgNB: 10
    arrivalRate: 2

# =============================================================================
# MONITORING EVENT
# =============================================================================
monitoringEvent:
  config:
    enabled: true
    data:
      nbi:
        httpVersion: 1
        useTLS: false
        fqdn: "3gpp-monitoing-event.local"
        port: 8080
      sbi:
        identitySvc: "http://nef-ue-identity:8080"
        redisSvc: "{{ .Values.redis.uri }}"
        httpVersion: 2
      supportedFeatures: "3fff"
      capifSvc: "{{ .Values.capif.address }}"
  nbi:
    httpVersion: 1
    useTLS: false
    fqdn: "3gpp-monitoing-event.local"
    port: 8080
  sbi:
    identitySvc: "http://nef-ue-identity:8080"
    redisSvc: "{{ .Values.redis.uri }}"
    httpVersion: 2
  supportedFeatures: "3fff"

# =============================================================================
# AS SESSION WITH QOS
# =============================================================================
asSessionWithQos:
  nbi:
    httpVersion: 1
    useTLS: false
    fqdn: "3gpp-as-session-with-qos.local"
    port: 8080
  sbi:
    nrfSvc: "http://nrf.net01.3gpp.eurecom.fr"
    useNrf: false
    pcfSvc: "http://core-simulator:8080"
    httpVersion: 2
  supportedFeatures: "3fff"
  qosConfig:
    qos-e:
      marBwDl: 120000
      marBwUl: 120000
      mediaType: CONTROL
    qos2:
      marBwDl: 240000
      marBwUl: 240000
      mediaType: CONTROL
    qos3:
      marBwDl: 480000
      marBwUl: 480000
      mediaType: AUDIO
    qos4:
      marBwDl: 960000
      marBwUl: 960000
      mediaType: VIDEO

# =============================================================================
# TRAFFIC INFLUENCE
# =============================================================================
trafficInfluence:
  nbi:
    httpVersion: 1
    useTLS: false
    fqdn: "3gpp-traffic-influence.local"
    port: 8080
  sbi:
    nrfSvc: "http://nrf.net01.3gpp.eurecom.fr"
    useNrf: false
    pcfSvc: "http://core-simulator:8080"
    httpVersion: 2

# =============================================================================
# UE IDENTITY
# =============================================================================
ueIdentity:
  config:
    enabled: true
    data:
      httpPort: 8080
      redisSvc: "{{ .Values.redis.address }}"
      nbiPort: 8080
      https: false
      httpVer: 1
  nbi:
    httpVersion: 1
    useTLS: false
    fqdn: "3gpp-ue-identity.local"
    port: 8080

# =============================================================================
# UE ID
# =============================================================================
ueId:
  config:
    enabled: true
    data:
      nbi:
        httpVersion: 1
        useTLS: false
        fqdn: 3gpp-ueid.local
        port: 8080
      sbi:
        identitySvc: "http://nef-ue-identity:8080"
        httpVersion: 1
      supportedFeatures: "3fff"
      capifSvc: "{{ .Values.capif.address }}"
  nbi:
    httpVersion: 1
    useTLS: false
    fqdn: "3gpp-ueid.local"
    port: 8080
  sbi:
    identitySvc: "http://nef-ue-identity:8080"
    httpVersion: 1
  supportedFeatures: "3fff"

# =============================================================================
# UE ADDRESS
# =============================================================================
ueAddress:
  config:
    enabled: true
    data:
      nbi:
        httpVersion: 1
        useTLS: false
        fqdn: 3gpp-ue-address.local
        port: 8080
      sbi:
        identitySvc: "http://nef-ue-identity:8080"
        profileSvc: "http://nef-ue-profile:8080"
        httpVersion: 1
      supportedFeatures: "3fff"
      capifSvc: "{{ .Values.capif.address }}"
  nbi:
    httpVersion: 1
    useTLS: false
    fqdn: "3gpp-ue-address.local"
    port: 8080
  sbi:
    identitySvc: "http://nef-ue-identity:8080"
    profileSvc: "http://nef-ue-profile:8080"
    httpVersion: 1
  supportedFeatures: "3fff"

# =============================================================================
# UE PROFILE
# =============================================================================
ueProfile:
  config:
    enabled: true
    data:
      https: false
      cnHttpVersion: 1
      redisSvc: "{{ .Values.redis.address }}"
      nbiPort: 8080
  nbi:
    httpVersion: 1
    useTLS: false
    fqdn: "3gpp-ue-profile.local"
    port: 8080

# =============================================================================
# CORE NETWORK
# =============================================================================
coreNetwork:
  config:
    enabled: true
    data:
      useNrf: false
      cnHttpVersion: "1"
      redisAddr: "{{ .Values.redis.address }}"
      redisSvc: "{{ .Values.redis.address }}"
      amfIpAddr: "http://nef-core-simulator:8080"
      amfSubscrRoute: "/namf-evts/v1"
      amfApiRoute: "/test/amf"
      amfNotifyCorrelationId: "string"
      amfNotificationId: "1"
      amfNotificationForwardRoute: "/sbi/notification/amf"
      smfIpAddr: "http://nef-core-simulator:8080"
      smfSubscrRoute: "/nsmf_event-exposure/v1"
      smfApiRoute: "/test/smf"
      smfNotifyCorrelationId: "string"
      smfNotificationId: "2"
      smfNotificationForwardRoute: "/sbi/notification/smf"
      eventNotifyUri: "http://nef-core-network:9090"
      serverAddr: "0.0.0.0:9090"
  amf:
    ipAddr: "http://nef-core-simulator:8080"
    subscrRoute: "/namf-evts/v1"
    apiRoute: "/test/amf"
    notifyCorrelationId: "string"
    notificationId: "1"
    notificationForwardRoute: "/sbi/notification/amf"
  smf:
    ipAddr: "http://nef-core-simulator:8080"
    subscrRoute: "/nsmf_event-exposure/v1"
    apiRoute: "/test/smf"
    notifyCorrelationId: "string"
    notificationId: "2"
    notificationForwardRoute: "/sbi/notification/smf"
  eventNotifyUri: "http://nef-core-network:9090"
  serverAddr: "0.0.0.0:9090"
  httpVersion: "1"
  useNrf: false

# =============================================================================
# CAPIF
# =============================================================================
capif:
  address: "nef-capif:8080"
  fqdn: "vm03.netsoft.cs.eurecom.fr"
  authPort: "8084"
  username: "nef-semproj"

# =============================================================================
# GRAFANA
# =============================================================================
grafana:
  # adminUser: "admin"
  # adminPassword: set via secret nef-grafana-secret

# =============================================================================
# INGRESS
# =============================================================================
ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
    # TLS and HTTPS enforcement
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    # Security headers
    nginx.ingress.kubernetes.io/configuration-snippet: |
      more_set_headers "X-Frame-Options: DENY";
      more_set_headers "X-Content-Type-Options: nosniff";
      more_set_headers "X-XSS-Protection: 1; mode=block";
      more_set_headers "Referrer-Policy: strict-origin-when-cross-origin";
      more_set_headers "Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'";
    # TLS configuration
    nginx.ingress.kubernetes.io/ssl-protocols: "TLSv1.2 TLSv1.3"
    nginx.ingress.kubernetes.io/ssl-ciphers: "ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305"
    nginx.ingress.kubernetes.io/ssl-prefer-server-ciphers: "true"
    # Rate limiting
    nginx.ingress.kubernetes.io/limit-rps: "100"
    nginx.ingress.kubernetes.io/limit-connections: "50"
  hosts:
  - host: nef.local
    paths:
    - path: /3gpp-as-session-with-qos
      pathType: Prefix
      service: nef-as-session-with-qos
      port: 8080
    - path: /3gpp-traffic-influence
      pathType: Prefix
      service: nef-traffic-influence
      port: 8080
    - path: /3gpp-monitoring-event
      pathType: Prefix
      service: nef-monitoring-event
      port: 8080
    - path: /3gpp-ue-id
      pathType: Prefix
      service: nef-ue-id
      port: 8080
    - path: /3gpp-ue-address
      pathType: Prefix
      service: nef-ue-address
      port: 8080
    - path: /grafana
      pathType: Prefix
      service: nef-grafana
      port: 3000
    - path: /prometheus
      pathType: Prefix
      service: nef-prometheus
      port: 9090
  tls:
  - secretName: nef-tls-cert
    hosts:
    - nef.local

# =============================================================================
# POLICIES
# =============================================================================
networkPolicy:
  enabled: true

podDisruptionBudget:
  enabled: true

# =============================================================================
# DEFAULTS (referenced by templates, override above if needed)
# =============================================================================
# global:
#   imagePullPolicy: IfNotPresent
#   imagePullSecrets: []
#
# # Default ports (8080 for most, exceptions below)
# # ports:
# #   coreNetwork: 9090
# #   redisInsight: 5540
# #   prometheus: 9090
# #   grafana: 3000
#
# # Default resources
# # resources:
# #   requests: { cpu: 100m, memory: 128Mi }
# #   limits: { cpu: 500m, memory: 512Mi }
#
# # Heavier services use:
# # resourceOverrides:
# #   coreNetwork: { requests: { cpu: 150m, memory: 256Mi }, limits: { cpu: 1000m, memory: 1Gi } }
# #   coreSimulator: { requests: { cpu: 200m, memory: 256Mi }, limits: { cpu: 1000m, memory: 1Gi } }
# #   prometheus: { requests: { cpu: 200m, memory: 512Mi }, limits: { cpu: 2000m, memory: 2Gi } }
# #   grafana: { requests: { cpu: 100m, memory: 256Mi }, limits: { cpu: 500m, memory: 1Gi } }
# #   redis: { requests: { cpu: 100m, memory: 256Mi }, limits: { cpu: 1000m, memory: 1Gi } }
#
# # Default security context (user 10001)
# # securityContext:
# #   runAsNonRoot: true
# #   runAsUser: 10001
# #   allowPrivilegeEscalation: false
# #   readOnlyRootFilesystem: true
# #   capabilities: { drop: [ALL] }
#
# # Special users:
# #   prometheus: 65534 (nobody)
# #   grafana: 472
# #   redisInsight: 1000 (also readOnlyRootFilesystem: false)
#
# # API config defaults in apiConfig section of templates
